import s from './index.module.css';
export function createAutocomplete({options=[],placeholder='Type to search...',onSelect=()=>{},onSearch=null}){const c=document.createElement('div');c.className=s.autocomplete;const input=document.createElement('input');input.className=s.input;input.placeholder=placeholder;const list=document.createElement('div');list.className=s.list;list.style.display='none';const render=(items)=>{list.innerHTML=items.map(i=>`<div class="${s.item}" data-value="${i.value}">${i.label}</div>`).join('');list.querySelectorAll('.'+s.item).forEach(el=>el.onclick=()=>{const item=items.find(i=>i.value===el.dataset.value);input.value=item.label;list.style.display='none';onSelect(item);});};input.oninput=async()=>{const q=input.value.toLowerCase();let filtered;if(onSearch){filtered=await onSearch(q);}else{filtered=options.filter(o=>o.label.toLowerCase().includes(q));}if(filtered.length&&q){list.style.display='block';render(filtered);}else{list.style.display='none';}};input.onfocus=()=>{if(input.value)input.oninput();};document.addEventListener('click',e=>{if(!c.contains(e.target))list.style.display='none';});c.append(input,list);return{el:c,getValue:()=>input.value,clear:()=>{input.value='';list.style.display='none';}};}