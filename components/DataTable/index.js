import s from './index.module.css';
export function createDataTable({columns=[],data=[],sortable=true,filterable=true,pageSize=10,onSort=()=>{}}){const c=document.createElement('div');c.className=s.container;let sortCol=null,sortDir='asc',filterVal='',page=0;const render=()=>{let filtered=data.filter(r=>!filterVal||Object.values(r).some(v=>String(v).toLowerCase().includes(filterVal.toLowerCase())));if(sortCol){filtered.sort((a,b)=>{const av=a[sortCol],bv=b[sortCol];return sortDir==='asc'?av>bv?1:-1:av<bv?1:-1;});}const start=page*pageSize;const paged=filtered.slice(start,start+pageSize);c.innerHTML='';if(filterable){const inp=document.createElement('input');inp.className=s.filter;inp.placeholder='Search...';inp.value=filterVal;inp.oninput=e=>{filterVal=e.target.value;page=0;render();};c.appendChild(inp);}const t=document.createElement('table');t.className=s.table;const thead=document.createElement('thead');const hr=document.createElement('tr');columns.forEach(col=>{const th=document.createElement('th');th.innerHTML=col.label+(sortCol===col.key?(sortDir==='asc'?' ↑':' ↓'):'');th.onclick=()=>{if(sortCol===col.key)sortDir=sortDir==='asc'?'desc':'asc';else{sortCol=col.key;sortDir='asc';}render();onSort(sortCol,sortDir);};hr.appendChild(th);});thead.appendChild(hr);t.appendChild(thead);const tbody=document.createElement('tbody');paged.forEach(row=>{const tr=document.createElement('tr');columns.forEach(col=>{const td=document.createElement('td');td.innerHTML=col.render?col.render(row[col.key],row):row[col.key];tr.appendChild(td);});tbody.appendChild(tr);});t.appendChild(tbody);c.appendChild(t);const pages=Math.ceil(filtered.length/pageSize);if(pages>1){const pg=document.createElement('div');pg.className=s.pagination;for(let i=0;i<pages;i++){const btn=document.createElement('button');btn.className=`${s.pageBtn} ${i===page?s.active:''}`;btn.textContent=i+1;btn.onclick=()=>{page=i;render();};pg.appendChild(btn);}c.appendChild(pg);}};render();return{el:c,refresh:render};}