import s from './index.module.css';
export function createStepForm({steps=[],onComplete=()=>{},onStepChange=()=>{}}){const c=document.createElement('div');c.className=s.stepform;let current=0;const render=()=>{c.innerHTML=`<div class="${s.progress}">${steps.map((st,i)=>`<div class="${s.step} ${i<current?s.done:''} ${i===current?s.active:''}">${i+1}</div>${i<steps.length-1?`<div class="${s.line} ${i<current?s.done:''}"></div>`:''}`).join('')}</div><div class="${s.content}"></div><div class="${s.actions}"><button class="${s.prev}" ${current===0?'disabled':''}>Back</button><button class="${s.next}">${current===steps.length-1?'Complete':'Next'}</button></div>`;const content=c.querySelector('.'+s.content);if(steps[current].render)content.appendChild(steps[current].render());c.querySelector('.'+s.prev).onclick=()=>{if(current>0){current--;render();onStepChange(current);}};c.querySelector('.'+s.next).onclick=async()=>{if(steps[current].validate){const valid=await steps[current].validate();if(!valid)return;}if(current<steps.length-1){current++;render();onStepChange(current);}else{onComplete();}};};render();return{el:c,goTo:i=>{current=i;render();},getCurrent:()=>current};}