import s from './index.module.css';
export function createMarketChart({data=[],height=200,showVolume=true}){const c=document.createElement('div');c.className=s.chart;c.style.height=height+'px';if(!data.length){c.innerHTML=`<div class="${s.empty}">No data</div>`;return c;}const maxPrice=Math.max(...data.map(d=>d.price));const minPrice=Math.min(...data.map(d=>d.price));const maxVol=Math.max(...data.map(d=>d.volume||0));const priceRange=maxPrice-minPrice||1;const chartH=showVolume?height*0.7:height;const points=data.map((d,i)=>{const x=(i/(data.length-1))*100;const y=chartH-((d.price-minPrice)/priceRange)*chartH*0.8-chartH*0.1;return`${x},${y}`;}).join(' ');c.innerHTML=`<svg class="${s.svg}" viewBox="0 0 100 ${height}" preserveAspectRatio="none"><defs><linearGradient id="grad" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#3b82f6" stop-opacity="0.3"/><stop offset="100%" stop-color="#3b82f6" stop-opacity="0"/></linearGradient></defs><polyline class="${s.line}" points="${points}"/><polygon class="${s.fill}" points="0,${chartH} ${points} 100,${chartH}"/></svg>${showVolume?`<div class="${s.volume}">${data.map((d,i)=>`<div class="${s.volBar}" style="height:${(d.volume||0)/maxVol*100}%;left:${(i/(data.length-1))*100}%"></div>`).join('')}</div>`:''}<div class="${s.labels}"><span>${minPrice.toFixed(0)}¢</span><span>${maxPrice.toFixed(0)}¢</span></div>`;return c;}