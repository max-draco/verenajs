import s from './index.module.css';
export function createPieChart({data=[],size=200,donut=false,showLegend=true}){const c=document.createElement('div');c.className=s.chart;if(!data.length)return c;const total=data.reduce((a,d)=>a+d.value,0);const cx=size/2,cy=size/2,r=size/2-10;let angle=0;const colors=['#3b82f6','#22c55e','#f59e0b','#ef4444','#8b5cf6','#ec4899'];let paths='';data.forEach((d,i)=>{const pct=d.value/total;const a1=angle,a2=angle+pct*Math.PI*2;const x1=cx+r*Math.cos(a1-Math.PI/2),y1=cy+r*Math.sin(a1-Math.PI/2);const x2=cx+r*Math.cos(a2-Math.PI/2),y2=cy+r*Math.sin(a2-Math.PI/2);const large=pct>0.5?1:0;const col=d.color||colors[i%colors.length];paths+=`<path d="M${cx},${cy} L${x1},${y1} A${r},${r} 0 ${large},1 ${x2},${y2} Z" fill="${col}"/>`;angle=a2;});if(donut)paths+=`<circle cx="${cx}" cy="${cy}" r="${r*0.6}" fill="#0f0f18"/>`;let legend='';if(showLegend){legend=`<div class="${s.legend}">${data.map((d,i)=>`<div class="${s.item}"><span class="${s.dot}" style="background:${d.color||colors[i%colors.length]}"></span>${d.label}: ${((d.value/total)*100).toFixed(1)}%</div>`).join('')}</div>`;}c.innerHTML=`<svg viewBox="0 0 ${size} ${size}" class="${s.svg}">${paths}</svg>${legend}`;return c;}