import s from './index.module.css';
export function createInfiniteScroll({loadMore=async()=>{},threshold=200,initialLoad=true}){const c=document.createElement('div');c.className=s.container;const content=document.createElement('div');content.className=s.content;const loader=document.createElement('div');loader.className=s.loader;loader.innerHTML='<div class="'+s.spinner+'"></div>';loader.style.display='none';c.append(content,loader);let loading=false,hasMore=true;const check=async()=>{if(loading||!hasMore)return;const scrollBottom=c.scrollHeight-c.scrollTop-c.clientHeight;if(scrollBottom<threshold){loading=true;loader.style.display='flex';const more=await loadMore();if(!more)hasMore=false;loader.style.display='none';loading=false;}};c.onscroll=check;if(initialLoad)setTimeout(check,0);return{el:c,append:(el)=>{content.appendChild(el);},reset:()=>{content.innerHTML='';hasMore=true;loading=false;check();},setHasMore:(v)=>hasMore=v};}